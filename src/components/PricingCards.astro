---
import PricingCard from "./PricingCard.astro";

const DATA_BASIC_PLAN = {
    tipo: "PLAN BÁSICO",
    clases: "MENTORÍA 1 MES",
    caracteristicas: [
        {
            texto: "MES COMPLETO DE CONTENIDO, COMUNIDAD Y GRABACIONES.",
            bold: "MES COMPLETO",
        },
        {
            texto: "PORTFOLIO LISTO + OFERTA ESTRUCTURADA PARA VENDER.",
            bold: "PORTFOLIO LISTO",
        },
        {
            texto: "ACCESO A COMUNIDAD DE DISCORD Y SOPORTE GRUPAL.",
            bold: "COMUNIDAD",
        },
        {
            texto: "IDEAL PARA SUBIR TU NIVEL TÉCNICO Y MONETIZAR.",
            bold: "SUBIR TU NIVEL",
        },
    ],
    precio: "300",
    precioAnterior: "500",
    accentColor: "var(--accent)", // Neon Yellow
    dataPlan: "basic",
    btnText: "APLICAR AHORA",
};

const DATA_PRO_PLAN = {
    tipo: "PLAN PRO",
    clases: "MENTORÍA PERSONALIZADA",
    caracteristicas: [
        {
            texto: "TODO LO DEL PLAN BÁSICO + ACOMPAÑAMIENTO 1:1.",
            bold: "TODO LO DEL PLAN BÁSICO",
        },
        {
            texto: "2 LLAMADAS 1:1 (45 MIN) PARA DESTRABAR Y ACELERAR.",
            bold: "2 LLAMADAS 1:1",
        },
        {
            texto: "REVISIÓN PERSONALIZADA DE TU OFERTA Y PACKS.",
            bold: "REVISIÓN PERSONALIZADA",
        },
        {
            texto: "PRIORIDAD DE RESPUESTA Y ACCESO DIRECTO.",
            bold: "PRIORIDAD",
        },
    ],
    precio: "600",
    precioAnterior: null,
    accentColor: "var(--accent)", // Neon Yellow
    dataPlan: "pro",
    btnText: "APLICAR AL PRO",
    badge: "/assets/resoures/rocket_sticker.webp",
};
---

<section id="pricing" class="relative w-full py-24 text-white font-sans">
    <img
        src="/assets/resoures/textures/texture_02.webp"
        alt="texture-trash"
        class="absolute inset-0 opacity-35 pointer-events-none mix-blend-screen"
    />
    <img
        src="/assets/resoures/rips/rip_01.webp"
        alt="texture-trash"
        class="absolute hidden md:block -top-30 -right-20 h-80 pointer-events-none rotate-90 z-20 invert brightness-0 opacity-40"
    />

    <!-- Urban Background Effects -->
    <div class="pointer-events-none">
        <div
            class="top-0 left-0 w-full h-full bg-[url('/assets/resoures/textures/texture_02.webp')] opacity-5 mix-blend-overlay bg-repeat"
        >
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 relative z-10">
        <!-- Section Title (Urban Style) -->
        <h2
            class="text-3xl sm:text-5xl md:text-7xl lg:text-8xl font-black text-center text-white mb-16 sm:mb-28 uppercase italic"
            style="font-family: 'Base Neue', sans-serif;"
        >
            CONVERTITE EN <span class="text-accent">DISEÑADOR PRO</span>
        </h2>

        <div
            class="flex flex-col lg:flex-row items-stretch justify-center gap-12 lg:gap-16 w-full"
        >
            <!-- Basic Plan -->
            <PricingCard {...DATA_BASIC_PLAN} />

            <!-- Pro Plan -->
            <PricingCard {...DATA_PRO_PLAN} />
        </div>

        <!-- Guarantee Section (Urban Dark) -->
        <div class="mt-40 max-w-3xl mx-auto text-center space-y-8">
            <h4
                class="text-3xl md:text-4xl font-black text-white uppercase italic tracking-tight"
                style="font-family: 'Base Neue', sans-serif;"
            >
                GARANTÍA SIN VUELTAS
            </h4>
            <div
                class="bg-zinc-900/50 border-2 border-white/5 p-10 rounded-3xl relative overflow-hidden group hover:border-white/10 transition-colors"
                style="clip-path: polygon(2% 0%, 100% 0%, 98% 100%, 0% 100%);"
            >
                <div
                    class="absolute inset-0 bg-white/2 opacity-0 group-hover:opacity-100 transition-opacity"
                >
                </div>
                <p
                    class="text-zinc-300 text-xl md:text-xl font-bold relative z-10 uppercase tracking-tight"
                >
                    Si aplicás el sistema por 2 semanas y ni así ves resultados,
                    tendremos una <a
                        href="#"
                        class="relative inline-block text-white font-black decoration-none group/link cursor-pointer hover:text-accent transition-colors"
                    >
                        <span class="relative z-10 text-accent"
                            >SESIÓN PERSONAL 1:1</span
                        >
                        <svg
                            class="snake-line absolute -bottom-2 -left-[7.5%] w-[115%] h-[12px] text-accent opacity-100"
                            width="100%"
                            height="12"
                            viewBox="0 0 100 12"
                            preserveAspectRatio="none"
                        >
                            <path
                                d="M0 6 Q 2.5 0, 5 6 T 10 6 T 15 6 T 20 6 T 25 6 T 30 6 T 35 6 T 40 6 T 45 6 T 50 6 T 55 6 T 60 6 T 65 6 T 70 6 T 75 6 T 80 6 T 85 6 T 90 6 T 95 6 T 100 6"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="3"
                                vector-effect="non-scaling-stroke"></path>
                        </svg>
                    </a> para encarrilarte.
                </p>
                <p
                    class="text-xs text-zinc-500 mt-6 relative z-10 uppercase tracking-[0.3em] font-black"
                >
                    YO TE DOY EL SISTEMA. VOS PONES LA GARRA.
                </p>
            </div>
        </div>
    </div>
</section>

<style>
    .snake-line path {
        stroke-dasharray: 1000;
        stroke-dashoffset: 0;
    }

    @keyframes snakeFlow {
        0% {
            stroke-dashoffset: 0;
        }
        100% {
            stroke-dashoffset: -200;
        }
    }

    .snake-line {
        animation: snakeWiggle 3s ease-in-out infinite;
    }

    @keyframes snakeWiggle {
        0%,
        100% {
            transform: translateX(0);
        }
        50% {
            transform: translateX(3px);
        }
    }
</style>

<script>
    function initButtons() {
        // Buttons inside cards
        const pricingBtns = document.querySelectorAll(".pricing-btn");
        pricingBtns.forEach((btn) => {
            const pricingBtn = btn as HTMLElement;
            pricingBtn.addEventListener("click", (e) => {
                e.preventDefault();
                e.stopPropagation();
                const plan = pricingBtn.dataset.plan as string;
                if (window.openLeadModal) {
                    window.openLeadModal(plan);
                } else {
                    console.error("LeadModal API not found on window");
                }
            });
        });

        // Add Card Clickability (UX Improvement)
        const cards = document.querySelectorAll(".urban-card-wrapper");
        cards.forEach((card) => {
            // @ts-ignore
            card.style.cursor = "pointer";
            card.addEventListener("click", (e) => {
                // Check if click came from button - if so, handled by button
                // @ts-ignore
                if (e.target.closest(".pricing-btn")) return;

                // Find the button inside this card to get the plan
                // @ts-ignore
                const btn = card.querySelector(".pricing-btn");
                if (btn) {
                    // @ts-ignore
                    btn.click();
                }
            });
        });
    }

    // Run on load
    initButtons();
</script>
